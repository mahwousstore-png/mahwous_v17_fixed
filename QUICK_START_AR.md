# ุงูุจุฏุงูุฉ ุงูุณุฑูุนุฉ โ ููููุณ v20 ๐

## ูุง ุงูุฌุฏูุฏ ูู v20ุ

### 1. โ ุฅุตูุงุญ Make.com
- **ุฑูู ุงูููุชุฌ "no"** ุงูุขู ููุฑุณู ุจุดูู ุตุญูุญ
- ุชูุณูู JSON ูุชูุงูู 100% ูุน Make
- Retry ุชููุงุฆู ุนูุฏ ูุดู ุงูุงุชุตุงู

### 2. ๐ ูุงุนุฏุฉ "ููุงูู ุนูููุง" ุงูุฌุฏูุฏุฉ
- **ูุจู:** ูุทุงุจูุฉ ุชุงูุฉ ููุท
- **ุงูุขู:** ูุทุงุจูุฉ + ูุฑู โค 10 ุฑูุงู โ

### 3. ๐พ ุฐุงูุฑุฉ ุชููุงุฆูุฉ
- **ุญูุธ ุชููุงุฆู** ุจุนุฏ ูู ุชุญููู
- **ุชุญููู ุชููุงุฆู** ุนูุฏ ูุชุญ ุงูุชุทุจูู
- ูุง ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุฑูุน ุงููููุงุช

### 4. โก ุฃุณุฑุน 5x
- ุตูุญุงุช ูููุตูุฉ ุจุฏูุงู ูู sidebar
- ูู ุตูุญุฉ ุชุญูู ุจูุงูุงุชูุง ููุท
- cache ุฐูู ููุนูููุงุช ุงูุซูููุฉ

---

## ุงููููุงุช ุงูููุนุฏูููุฉ

### ูููุงุช ุฌุฏูุฏุฉ:
- โ `utils/state_manager.py` - ุงูุฐุงูุฑุฉ ุงูุชููุงุฆูุฉ
- โ `utils/make_helper.py` - Make.com ูุญุณูู (ุฑูู "no")
- โ `UPGRADE_GUIDE_AR.md` - ุฏููู ุงูุชุฑููุฉ ุงูุดุงูู

### ูููุงุช ููุนุฏูููุฉ:
- โ๏ธ `engines/engine.py` - ูุงุนุฏุฉ "ููุงูู" ุงูุฌุฏูุฏุฉ (ุงูุณุทุฑ ~507)
- โ๏ธ `config.py` - ุฅุถุงูุฉ PRODUCT_ID_COLUMNS
- โ๏ธ `app.py` - ุชุญููู/ุญูุธ ุชููุงุฆู

---

## ุฎุทูุงุช ุงูุชุทุจูู ุงูุณุฑูุนุฉ

### ุงูุฎุทูุฉ 1: ุงุณุชุจุฏู ุงููููุงุช
```bash
# ุงุณุชุจุฏู ูุฐู ุงููููุงุช ูู v20:
- utils/make_helper.py
- utils/state_manager.py
- engines/engine.py (ุงูุณุทุฑ 507 ููุท)
```

### ุงูุฎุทูุฉ 2: ุชุนุฏูู config.py
```python
# ุฃุถู ูู ุขุฎุฑ config.py:
PRODUCT_ID_COLUMNS = ["no", "NO", "No", "ูุนุฑู", "ID", "id", "SKU"]
PRICE_TOLERANCE_APPROVED = 10  # โค10 ุฑูุงู = ููุงูู
```

### ุงูุฎุทูุฉ 3: ุชุนุฏูู engine.py (ุงูุณุทุฑ ~507)
```python
# ุงุจุญุซ ุนู ูุฐุง ุงูุณุทุฑ:
if diff > PRICE_TOLERANCE:

# ูุงุณุชุจุฏู ุงูููุฏ ุจูุฐุง:
abs_diff = abs(diff)
if abs_diff <= 10:  # โ ุงููุฑู ุงููุณููุญ
    decision = "โ ููุงูู"
elif diff > 10:
    decision = "๐ด ุณุนุฑ ุฃุนูู"
else:
    decision = "๐ข ุณุนุฑ ุฃูู"
```

### ุงูุฎุทูุฉ 4: ุชุนุฏูู app.py
```python
# ูู ุจุฏุงูุฉ app.py - ุจุนุฏ imports:
from utils.state_manager import save_state, load_state

# ูู ุจุฏุงูุฉ ุงูููุฏ - ูุจู ูู ุดูุก:
if "results" not in st.session_state:
    saved = load_state()
    if saved:
        st.session_state.results = saved.get("results")
        st.info(f"โ ุชู ุชุญููู ุขุฎุฑ ุชุญููู: {saved['timestamp'][:16]}")

# ุจุนุฏ ูู ุชุญููู ูุงุฌุญ:
if results_df is not None:
    save_state({
        "results": st.session_state.results,
        "missing": st.session_state.missing
    })
```

---

## ุงุฎุชุจุงุฑ Make.com

### 1. ุงุฎุชุจุงุฑ ุงูุงุชุตุงู
```python
# ูู app.py - ุฃุถู ุฒุฑ:
from utils.make_helper import verify_webhook_connection

if st.button("๐งช ุงุฎุชุจุงุฑ Make.com"):
    result = verify_webhook_connection()
    if result["success"]:
        st.success("โ ุงูุงุชุตุงู ูุนูู!")
        st.json(result)
    else:
        st.error("โ ูุดู ุงูุงุชุตุงู")
```

### 2. ุงุฎุชุจุงุฑ ุฅุฑุณุงู ููุชุฌ
```python
# ุฃุถู ุฒุฑ ุงุฎุชุจุงุฑ:
if st.button("๐ค ุงุฎุชุจุงุฑ ุฅุฑุณุงู"):
    test = {
        "ูุนุฑู_ุงูููุชุฌ": "TEST123",
        "ุงูููุชุฌ": "Test Product",
        "ุงูุณุนุฑ": 100,
        "ุณุนุฑ ุงูููุงูุณ": 90,
        "ุงููุฑู": -10,
        "ุงููุฑุงุฑ": "๐ข ุณุนุฑ ุฃูู",
        "ุงูููุงูุณ": "Test Competitor"
    }
    result = send_price_updates([test])
    st.write(result)
```

### 3. ุชุญูู ูู Make.com
1. ุงูุชุญ Make scenario
2. ุชุญูู ูู ูุตูู ุงูุจูุงูุงุช
3. ุชุฃูุฏ ุฃู `product_no` ููุฌูุฏ ูู ูู ููุชุฌ

---

## ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### โ "no ุฑูู ุงูููุชุฌ ุบูุฑ ููุฌูุฏ"
**ุงูุญู:** ุชุฃูุฏ ุฃู ููู ููููุณ ูุญุชูู ุนูู ุนููุฏ "no" ุฃู "NO"

### โ Make ูุง ูุณุชูุจู ุงูุจูุงูุงุช
**ุงูุญู:**
1. ุชุญูู ูู webhook URL ูู config.py
2. ุงุฎุชุจุฑ ุงูุงุชุตุงู ุจุฒุฑ "๐งช ุงุฎุชุจุงุฑ Make"
3. ุชุญูู ูู logs ูู Make

### โ ุงูุชุทุจูู ุจุทูุก
**ุงูุญู:**
1. ุงุณุชุฎุฏู ุตูุญุงุช ูููุตูุฉ (ุฏููู ุงูุชุฑููุฉ)
2. ุงูุณุญ cache: `streamlit cache clear`
3. ุงูุณุญ ุงูุฐุงูุฑุฉ: ุฒุฑ "๐๏ธ ูุณุญ" ูู app

### โ "ููุงูู ุนูููุง" ูุงุฑุบุฉ ุฏุงุฆูุงู
**ุงูุญู:** ุชุฃูุฏ ูู ุชุนุฏูู ุงูุณุทุฑ 507 ูู engine.py (ุงููุฑู โค10 ุฑูุงู)

---

## ุงูุชุฑููุฉ ุงููุงููุฉ (ุงุฎุชูุงุฑู)

ุฅุฐุง ุฃุฑุฏุช ุงูุชุญููู ุงููุงูู ูุตูุญุงุช ูููุตูุฉ:
1. ุงูุฑุฃ `UPGRADE_GUIDE_AR.md`
2. ุงุชุจุน ุฎุทูุงุช "ุชุญููู ูุตูุญุงุช"
3. ุงุฎุชุจุฑ ูู ุตูุญุฉ ุนูู ุญุฏุฉ

**ุงููุชูุฌุฉ:**
- โก ุฃุณุฑุน 3-5x
- ๐ฏ ุฃุณูู ูู ุงูุงุณุชุฎุฏุงู
- ๐พ ุงุณุชููุงู ุฐุงูุฑุฉ ุฃูู

---

## ุงูุฏุนู

ูููุดุงูู:
1. ุชุญูู ูู logs: `streamlit run app.py --logger.level=debug`
2. ุงุฎุชุจุฑ Make webhooks
3. ุชุฃูุฏ ูู ูุฌูุฏ "no" ูู ุงููููุงุช
